<h2 mat-dialog-title class="title">
    {{ title() }}
</h2>

<div mat-dialog-content class="content">
    <div class="grid">
        <!-- LEFT: Selection list -->
        <section class="list-pane">
            <div class="pane-title">{{ listLabel() }}</div>
            <!-- ✅ ADD: Filter/Search bar -->
            <mat-form-field appearance="outline" class="filter-field">
                <mat-label>Search</mat-label>
                <input matInput [formControl]="filterCtrl" placeholder="Type to filter..." />

                @if (filterCtrl.value) {
                    <button mat-icon-button matSuffix type="button" (click)="clearFilter()">
                        <mat-icon>close</mat-icon>
                    </button>
                } @else {
                    <mat-icon matSuffix>search</mat-icon>
                }
            </mat-form-field>


            @if (data.options.length === 0) {
                <div class="empty"> No items available. </div>
            } @else if(filteredOptions().length === 0) {
                <div class="empty"> No items available. </div>
            } @else{

                <div class="selection-wrap">

                <mat-selection-list [multiple]="false" class="selection">
                    @for (opt of filteredOptions(); track opt.id) {
                        <mat-list-option
                            [selected]="selectedId() === opt.id"
                            (click)="onSelectionChange(opt.id)">
                            {{ opt.name }}
                        </mat-list-option>
                    }
                </mat-selection-list>
                </div>
            }
        </section>

        <!-- RIGHT: Inputs -->
        <section class="form-pane" [formGroup]="form">
            <mat-form-field appearance="outline" class="field">
                <mat-label>Position</mat-label>
                <input matInput formControlName="position" placeholder="e.g., Visiting Dentist / Staff" />
            </mat-form-field>

            <mat-form-field appearance="outline" class="field">
                <mat-label>Schedule</mat-label>
                <input matInput formControlName="schedule" placeholder="e.g., Mon/Wed 9am–3pm" />
            </mat-form-field>

            <div class="preview">
                @if (selectedOption(); as sel) {
                    <div class="chipline">
            <span class="chip">
              {{ data.mode === 'dentist' ? 'Dentist' : 'Clinic' }}: <b>{{ sel.name }}</b>
            </span>
                    </div>
                } @else {
                    <div class="hint">Pick one from the list to enable Save.</div>
                }
            </div>
        </section>
    </div>
</div>

<div mat-dialog-actions align="end" class="actions">
    <button mat-button type="button" (click)="onCancel()">Cancel</button>
    <button mat-flat-button type="button" [disabled]="!canSave()" (click)="onSave()">
        Save
    </button>
</div>
